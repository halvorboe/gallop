syntax = "proto3";

package protos;

import "common.proto";


message SegmentMeta {
  string id = 1;
  uint64 timestamp = 2; 
  enum Resolution {
      HOUR = 0;
      DAY = 1;
      WEEK = 2;
  }
  Resolution resolution = 3;
}

message Segment {
  SegmentMeta meta = 1;
  repeated Row Row = 2;
}


message SegmentRequest {
  
}

message SegmentResponse {
  Segment segments = 1;
}

message SegmentsRequest {
}

message SegmentsResponse {
  repeated SegmentMeta segments = 2;
}

message ConfigureRequest {
  repeated Table tables = 1;
}

message InsertRequest {
  string table_name = 1;
  Row row = 2;
}


service Storage {
  rpc Configure(ConfigureRequest) returns (Error) {}
  rpc Insert(InsertRequest) returns (Error) {}
  rpc Segment(SegmentRequest) returns (SegmentResponse) {}
  rpc Segments(SegmentsRequest) returns (SegmentsResponse) {}
}
